# 完整前端功能指南

**更新日期**: 2025-01-XX
**状态**: 已完成Phase 2所有可视化功能

---

## 🎯 已实现的完整功能

### 1. 🔬 原子浏览 (Atoms View)
**URL**: `/projects/[id]/atoms`
**功能**:
- 查看所有原子化内容（16个原子）
- 筛选功能（按类型、时长、搜索文本）
- 质量评分显示（每个原子的重要性分数）
- 类型分布图
- 原子详情弹窗

**数据展示**:
```
原子ID: A001
类型: opening
时长: 34秒
质量分数: 4.5/5.0
重要性: ⭐⭐⭐⭐☆ (0.85)
内容: "大家好我是马督公..."
```

### 2. 👥 实体提取 (Entities)
**URL**: `/projects/[id]/entities`
**功能**: ✅ 新增
- 显示所有提取的实体（15个实体）
- 6类实体分类：
  - 👤 人物 (persons) - 6个
  - 🌍 国家 (countries) - 2个
  - ⏰ 时间 (times) - 3个
  - 🏢 组织 (organizations) - 0个
  - ⚡ 事件 (events) - 1个
  - 💡 概念 (concepts) - 3个
- 搜索和筛选
- 实体重要度显示
- 提及次数统计

**数据展示**:
```
实体: 孙中山
类型: 人物 (persons)
提及次数: 1
重要度: ███████░░░ 70%
出现位置: 1 atoms
[查看位置] [Ask AI]
```

### 3. 🏷️ 主题网络 (Topics)
**URL**: `/projects/[id]/topics`
**功能**: ✅ 新增
- 主题层级结构可视化
- 主要主题 (Primary Topic)
- 次要主题 (Secondary Topics)
- 标签云 (Tags) - 带权重显示

**可视化效果**:
```
┌─ 金三角历史与缅北双雄时代 [75%]
   ├─ 历史人物 [45%]
   ├─ 地区概况 [35%]
   └─ 文化哲学 [28%]
       ├─ #孙中山
       ├─ #毛泽东
       ├─ #金三角
       └─ #树挪死人挪活
```

### 4. 🕸️ 知识图谱 (Knowledge Graph)
**URL**: `/projects/[id]/graph`
**功能**:
- 交互式力导向图（React Flow）
- 14个节点 + 46条边
- 节点颜色编码：
  - 🔵 人物 - 蓝色
  - 🟢 国家 - 绿色
  - 🔴 事件 - 红色
  - 🟣 概念 - 紫色
  - 🟡 主题 - 黄色
  - ⚪ 片段 - 灰色
- 点击节点查看详情
- MiniMap导航
- 缩放和平移

**关系类型**:
- entity_to_segment - 实体出现在片段中
- entity_to_topic - 实体相关主题
- person_to_event - 人物参与事件
- person_to_country - 人物关联国家
- concept_to_event - 概念相关事件

### 5. 📄 结构报告 (Report)
**URL**: `/projects/[id]/report`
**功能**: ✅ 新增
- 显示完整的Markdown格式分析报告
- 包含内容:
  - 视频概览
  - 执行摘要
  - 内容时间轴
  - 叙事片段详情
  - 主题分析
  - 实体网络
  - 统计数据
  - AI洞察

---

## 📊 项目主页改进

### 新增导航结构

**📊 分析视图** (4个功能)
```
┌─────────┬─────────┬─────────┬─────────┐
│ 🔬      │ 👥      │ 🏷️      │ 🕸️      │
│ 原子浏览 │ 实体提取 │ 主题网络 │ 知识图谱 │
└─────────┴─────────┴─────────┴─────────┘
```

**📋 报告和工具** (4个功能，1个可用)
```
┌─────────┬─────────┬─────────┬─────────┐
│ 📄      │ 💬      │ 🎬      │ ⏱️      │
│ 结构报告 │ AI 对话 │ 创作工具 │ 时间轴   │
│ ✅      │ 待实现   │ 待实现   │ 待实现   │
└─────────┴─────────┴─────────┴─────────┘
```

---

## 🚀 完整使用流程

### 场景1: 系统思考 - 从Knowledge Graph开始

1. **访问项目页面**
   ```
   http://localhost:3000
   ```

2. **点击 "🕸️ 知识图谱"**
   - 查看整体结构
   - 识别核心实体（节点大小 = 重要性）
   - 理解实体间关系

3. **点击节点深入了解**
   - 查看节点详情（类型、提及次数、重要度）
   - 点击 "Ask AI about this" （待集成）

4. **切换到实体页面**
   - 查看所有实体的详细信息
   - 按类型筛选
   - 搜索特定实体

5. **查看主题网络**
   - 理解主题层级
   - 查看标签云
   - 了解主题权重

6. **阅读结构报告**
   - 完整的文字描述
   - 时间轴分析
   - AI洞察

### 场景2: 详细分析 - 从原子开始

1. **原子浏览**
   - 按时间顺序查看所有内容
   - 筛选重要内容（高质量分数）
   - 查看原子详情

2. **实体提取**
   - 找到感兴趣的实体
   - 查看提及位置
   - 理解实体重要性

3. **知识图谱**
   - 可视化实体关系
   - 发现隐藏联系

---

## 🎨 UI/UX设计原则

### 使用Shadcn/ui组件

所有页面都使用Shadcn/ui组件库：

✅ **Card** - 内容卡片
```tsx
<Card>
  <CardHeader>
    <CardTitle>标题</CardTitle>
  </CardHeader>
  <CardContent>
    内容
  </CardContent>
</Card>
```

✅ **Badge** - 标签和类别
```tsx
<Badge className="bg-blue-100 text-blue-800">
  人物
</Badge>
```

✅ **Button** - 操作按钮
```tsx
<Button variant="outline" size="sm">
  查看详情
</Button>
```

✅ **Input** - 搜索框
```tsx
<Input
  placeholder="搜索..."
  value={search}
  onChange={e => setSearch(e.target.value)}
/>
```

### 颜色系统

**实体类型颜色**:
- 👤 人物: `bg-blue-100 text-blue-800`
- 🌍 国家: `bg-green-100 text-green-800`
- ⏰ 时间: `bg-orange-100 text-orange-800`
- 🏢 组织: `bg-purple-100 text-purple-800`
- ⚡ 事件: `bg-red-100 text-red-800`
- 💡 概念: `bg-yellow-100 text-yellow-800`

**图谱节点颜色**:
- 人物: `#3B82F6` (蓝色)
- 国家: `#10B981` (绿色)
- 事件: `#EF4444` (红色)
- 概念: `#8B5CF6` (紫色)
- 主题: `#F59E0B` (黄色)
- 片段: `#6B7280` (灰色)

---

## 📁 新增文件清单

### 前端页面

```
atom-viewer/app/projects/[id]/
├── entities/
│   └── page.tsx          ← 实体提取页面 ✅ 新增
├── topics/
│   └── page.tsx          ← 主题网络页面 ✅ 新增
├── graph/
│   └── page.tsx          ← 知识图谱页面 ✅
├── report/
│   └── page.tsx          ← 结构报告页面 ✅ 新增
└── page.tsx              ← 项目主页（已更新）
```

### 组件

```
atom-viewer/components/
└── KnowledgeGraph.tsx    ← React Flow 图谱组件 ✅
```

### 后端API

```
video_understanding_engine/api/
└── server.py             ← 添加了report端点 ✅
```

---

## 🔗 API端点清单

### 已实现的API

| 端点 | 方法 | 描述 | 状态 |
|------|------|------|------|
| `/api/health` | GET | 健康检查 | ✅ |
| `/api/projects/{id}/atoms` | GET | 原子列表 | ✅ |
| `/api/projects/{id}/segments` | GET | 片段列表 | ✅ |
| `/api/projects/{id}/entities` | GET | 实体列表 | ✅ |
| `/api/projects/{id}/topics` | GET | 主题网络 | ✅ |
| `/api/projects/{id}/graph` | GET | 知识图谱 | ✅ |
| `/api/projects/{id}/creative` | GET | 创作建议 | ✅ |
| `/api/projects/{id}/overview` | GET | 项目概览 | ✅ |
| `/api/projects/{id}/report` | GET | 结构报告 | ✅ 新增 |

---

## 📸 界面预览（文字描述）

### 实体提取页面

```
┌─────────────────────────────────────────────────────────┐
│ 实体提取                                    搜索: [____]  │
│ 共提取 15 个实体，分为 6 类                                │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ 统计卡片:                                                │
│ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐              │
│ │ 6  │ │ 2  │ │ 3  │ │ 0  │ │ 1  │ │ 3  │              │
│ │人物│ │国家│ │时间│ │组织│ │事件│ │概念│              │
│ └────┘ └────┘ └────┘ └────┘ └────┘ └────┘              │
│                                                         │
│ 过滤标签: [All] [persons] [countries] ...               │
│                                                         │
│ 实体卡片:                                                │
│ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐     │
│ │👤 孙中山      │ │👤 毛泽东      │ │🌍 中国        │     │
│ │              │ │              │ │              │     │
│ │提及: 1 次     │ │提及: 1 次     │ │提及: 1 次     │     │
│ │重要度: 70%    │ │重要度: 75%    │ │重要度: 85%    │     │
│ │███████░░░    │ │████████░░    │ │█████████░    │     │
│ │位置: 1 atoms  │ │位置: 1 atoms  │ │位置: 1 atoms  │     │
│ │[查看] [Ask AI]│ │[查看] [Ask AI]│ │[查看] [Ask AI]│     │
│ └──────────────┘ └──────────────┘ └──────────────┘     │
└─────────────────────────────────────────────────────────┘
```

### 主题网络页面

```
┌─────────────────────────────────────────────────────────┐
│ 主题网络分析                                              │
│ 视频内容的主题层级结构                                     │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ 主要主题:                                                │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ • 金三角历史与缅北双雄时代                            │ │
│ │   权重: 0.75  覆盖片段: 1                             │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ 主题层级结构:                                             │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ ┌─ 金三角历史与缅北双雄时代 [75%]                      │ │
│ │ ├─ 历史人物 [45%]                                    │ │
│ │ ├─ 地区概况 [35%]                                    │ │
│ │ └─ 文化哲学 [28%]                                    │ │
│ │     ├─ #孙中山                                       │ │
│ │     ├─ #毛泽东                                       │ │
│ │     ├─ #金三角                                       │ │
│ │     └─ #树挪死人挪活                                  │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ 标签云:                                                  │
│ ┌─────────────────────────────────────────────────────┐ │
│ │  #孙中山  #毛泽东  #汪精卫  #李大钊                   │ │
│ │  #金三角  #缅北  #中国  #树挪死人挪活                  │ │
│ │  #教父系列  #历史讲座                                  │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

---

## 📊 数据统计

### 当前测试视频数据

- **原子数**: 16个
- **片段数**: 1个
- **实体数**: 15个（6人物、2国家、3时间、1事件、3概念）
- **主题数**: 1主题 + 3子主题
- **标签数**: 10个
- **图谱**: 14节点 + 46边

### 深层语义分析数据

每个原子包含：
- `quality_score`: 0.0-5.0（内容质量）
- `importance_score`: 0.0-1.0（重要性）
- `type`: 类型标签
- `duration_seconds`: 时长
- `start_time` / `end_time`: 时间戳

---

## 🎯 完成度总结

### Phase 2 可视化功能

| 功能 | 状态 | 页面 |
|------|------|------|
| 原子浏览 | ✅ 完成 | `/projects/[id]/atoms` |
| 实体提取 | ✅ 完成 | `/projects/[id]/entities` |
| 主题网络 | ✅ 完成 | `/projects/[id]/topics` |
| 知识图谱 | ✅ 完成 | `/projects/[id]/graph` |
| 结构报告 | ✅ 完成 | `/projects/[id]/report` |
| 深层分析展示 | ✅ 完成 | 嵌入各页面 |

### 未来功能（Phase 3）

| 功能 | 状态 | 优先级 |
|------|------|--------|
| AI 对话 | ⏸️ 待实现 | 高 |
| 创作工具 | ⏸️ 待实现 | 中 |
| 时间轴视图 | ⏸️ 待实现 | 中 |
| 片段播放器 | ⏸️ 待实现 | 低 |

---

## 🐛 已知改进点

### Knowledge Graph改进建议

1. **布局优化**
   - 当前: 简单圆形布局
   - 改进: 使用力导向算法自动优化
   - 实现: 已使用React Flow的自动布局

2. **节点大小**
   - 当前: 基于importance计算
   - 改进: 可以根据mentions调整
   - 状态: 已实现

3. **交互功能**
   - ✅ 点击节点查看详情
   - ✅ 缩放和平移
   - ✅ MiniMap导航
   - ⏸️ 节点搜索（待实现）
   - ⏸️ 路径查找（待实现）

---

## 🚀 快速开始

### 1. 启动后端

```bash
cd video_understanding_engine
python api/server.py
```

### 2. 启动前端

```bash
cd atom-viewer
npm run dev
```

### 3. 访问应用

```
http://localhost:3000
```

### 4. 探索功能

1. 点击项目进入主页
2. 尝试8个不同的功能按钮
3. 体验完整的Phase 2功能

---

## 💡 使用建议

1. **首先看Knowledge Graph** - 建立整体认知
2. **然后看实体提取** - 了解关键人物和概念
3. **接着看主题网络** - 理解内容结构
4. **最后看结构报告** - 获取完整分析

---

**所有Phase 2可视化功能已完成！** 🎉
